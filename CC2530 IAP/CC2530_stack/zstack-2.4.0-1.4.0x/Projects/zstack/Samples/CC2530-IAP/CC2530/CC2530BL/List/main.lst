###############################################################################
#
# IAR C/C++ Compiler V9.10.1.2146 for 8051                07/Jul/2023  16:40:18
# Copyright 2004-2014 IAR Systems AB.
# Standalone license - IAR Embedded Workbench for 8051
#
#    Core               =  plain
#    Code model         =  near
#    Data model         =  large
#    Calling convention =  xdata reentrant
#    Constant location  =  data
#    Dptr setup         =  1,16
#                          
#    Source file        =  
#        I:\1_git_code\EPnode_OTA\CC2530
#        IAP\CC2530_stack\zstack-2.4.0-1.4.0x\Projects\zstack\Samples\CC2530-IAP\Source\main.c
#    Command line       =  
#        "I:\1_git_code\EPnode_OTA\CC2530
#        IAP\CC2530_stack\zstack-2.4.0-1.4.0x\Projects\zstack\Samples\CC2530-IAP\Source\main.c"
#        -D HAL_SB_BOOT_CODE -D HAL_UART=TRUE -D HAL_UART_DMA=0 -D
#        HAL_UART_ISR=1 -D HAL_UART_ISR_RX_MAX=254 -lC
#        "I:\1_git_code\EPnode_OTA\CC2530
#        IAP\CC2530_stack\zstack-2.4.0-1.4.0x\Projects\zstack\Samples\CC2530-IAP\CC2530\CC2530BL\List\"
#        -lA "I:\1_git_code\EPnode_OTA\CC2530
#        IAP\CC2530_stack\zstack-2.4.0-1.4.0x\Projects\zstack\Samples\CC2530-IAP\CC2530\CC2530BL\List\"
#        --diag_suppress Pe001,Pa010,Pa050 -o "I:\1_git_code\EPnode_OTA\CC2530
#        IAP\CC2530_stack\zstack-2.4.0-1.4.0x\Projects\zstack\Samples\CC2530-IAP\CC2530\CC2530BL\Obj\"
#        -e --debug --core=plain --dptr=16,1 --data_model=large
#        --code_model=near --calling_convention=xdata_reentrant
#        --place_constants=data --nr_virtual_regs 8 -I
#        "I:\1_git_code\EPnode_OTA\CC2530
#        IAP\CC2530_stack\zstack-2.4.0-1.4.0x\Projects\zstack\Samples\CC2530-IAP\CC2530\..\Source\drive\"
#        -I "I:\1_git_code\EPnode_OTA\CC2530
#        IAP\CC2530_stack\zstack-2.4.0-1.4.0x\Projects\zstack\Samples\CC2530-IAP\CC2530\..\Source\iap\"
#        -I "I:\1_git_code\EPnode_OTA\CC2530
#        IAP\CC2530_stack\zstack-2.4.0-1.4.0x\Projects\zstack\Samples\CC2530-IAP\CC2530\..\Source\shell\"
#        -I "I:\1_git_code\EPnode_OTA\CC2530
#        IAP\CC2530_stack\zstack-2.4.0-1.4.0x\Projects\zstack\Samples\CC2530-IAP\CC2530\..\Source\sys\"
#        -I "I:\1_git_code\EPnode_OTA\CC2530
#        IAP\CC2530_stack\zstack-2.4.0-1.4.0x\Projects\zstack\Samples\CC2530-IAP\CC2530\..\Source\"
#        -I "I:\1_git_code\EPnode_OTA\CC2530
#        IAP\CC2530_stack\zstack-2.4.0-1.4.0x\Projects\zstack\Samples\CC2530-IAP\CC2530\source\"
#        -I "I:\1_git_code\EPnode_OTA\CC2530
#        IAP\CC2530_stack\zstack-2.4.0-1.4.0x\Projects\zstack\Samples\CC2530-IAP\CC2530\..\..\common\"
#        -I "I:\1_git_code\EPnode_OTA\CC2530
#        IAP\CC2530_stack\zstack-2.4.0-1.4.0x\Projects\zstack\Samples\CC2530-IAP\CC2530\..\..\..\ZMain\TI2530DB\"
#        -I "I:\1_git_code\EPnode_OTA\CC2530
#        IAP\CC2530_stack\zstack-2.4.0-1.4.0x\Projects\zstack\Samples\CC2530-IAP\CC2530\..\..\..\..\..\Components\hal\include\"
#        -I "I:\1_git_code\EPnode_OTA\CC2530
#        IAP\CC2530_stack\zstack-2.4.0-1.4.0x\Projects\zstack\Samples\CC2530-IAP\CC2530\..\..\..\..\..\Components\hal\target\_COMMON\CC2530\"
#        -I "I:\1_git_code\EPnode_OTA\CC2530
#        IAP\CC2530_stack\zstack-2.4.0-1.4.0x\Projects\zstack\Samples\CC2530-IAP\CC2530\..\..\..\..\..\Components\hal\target\CC2530EB\"
#        -I "I:\1_git_code\EPnode_OTA\CC2530
#        IAP\CC2530_stack\zstack-2.4.0-1.4.0x\Projects\zstack\Samples\CC2530-IAP\CC2530\..\..\..\..\..\Components\osal\include\"
#        -I "I:\1_git_code\EPnode_OTA\CC2530
#        IAP\CC2530_stack\zstack-2.4.0-1.4.0x\Projects\zstack\Samples\CC2530-IAP\CC2530\..\..\..\..\..\Components\services\saddr\"
#        -Ohz
#    List file          =  
#        I:\1_git_code\EPnode_OTA\CC2530
#        IAP\CC2530_stack\zstack-2.4.0-1.4.0x\Projects\zstack\Samples\CC2530-IAP\CC2530\CC2530BL\List\main.lst
#    Object file        =  
#        I:\1_git_code\EPnode_OTA\CC2530
#        IAP\CC2530_stack\zstack-2.4.0-1.4.0x\Projects\zstack\Samples\CC2530-IAP\CC2530\CC2530BL\Obj\main.r51
#
###############################################################################

I:\1_git_code\EPnode_OTA\CC2530 IAP\CC2530_stack\zstack-2.4.0-1.4.0x\Projects\zstack\Samples\CC2530-IAP\Source\main.c
      1          #include "sys.h"

   \                                 In  segment SFR_AN, at 0x8f
   \   unsigned char volatile __sfr P0INP
   \                     P0INP:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0x90
   \   union <unnamed> volatile __sfr _A_P1
   \                     _A_P1:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0x9d
   \   unsigned char volatile __sfr SLEEPSTA
   \                     SLEEPSTA:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0x9e
   \   unsigned char volatile __sfr CLKCONSTA
   \                     CLKCONSTA:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xbe
   \   unsigned char volatile __sfr SLEEPCMD
   \                     SLEEPCMD:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xc6
   \   unsigned char volatile __sfr CLKCONCMD
   \                     CLKCONCMD:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xd4
   \   unsigned char volatile __sfr DMA0CFGL
   \                     DMA0CFGL:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xd5
   \   unsigned char volatile __sfr DMA0CFGH
   \                     DMA0CFGH:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xfe
   \   unsigned char volatile __sfr P1DIR
   \                     P1DIR:
   \   000000                DS 1
      2          #include "uart.h"
      3          #include "download.h"
      4          #include "app_start.h"
      5          #include "shell.h"
      6          #include "user_cmd.h"
      7          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
      8          sys_parameter_t sys_parameter;
   \                     sys_parameter:
   \   000000                DS 2
   \   000002                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
      9          halDMADesc_t dmaCh0;
   \                     dmaCh0:
   \   000000                DS 8
   \   000008                REQUIRE __INIT_XDATA_Z
     10          
     11          // 系统初始化

   \                                 In  segment NEAR_CODE, align 1, keep-with-next
     12          static void system_init()
   \                     system_init:
     13          {
   \   000000                REQUIRE ?V0
   \   000000                REQUIRE ?V1
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?FUNC_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
     14            /* 初始化系统基本硬件 */
     15            HAL_BOARD_INIT();
   \   000005   53BEFB       ANL     0xbe,#0xfb
   \                     ??system_init_0:
   \   000008   E59D         MOV     A,0x9d
   \   00000A   A2E6         MOV     C,0xE0 /* A   */.6
   \   00000C   50FA         JNC     ??system_init_0
   \   00000E   00           NOP
   \   00000F   78F8         MOV     R0,#-0x8
   \   000011   7901         MOV     R1,#0x1
   \                     ??system_init_1:
   \   000013   00           NOP
   \   000014   E8           MOV     A,R0
   \   000015   24FF         ADD     A,#-0x1
   \   000017   18           DEC     R0
   \   000018   E9           MOV     A,R1
   \   000019   34FF         ADDC    A,#-0x1
   \   00001B   F9           MOV     R1,A
   \   00001C   E8           MOV     A,R0
   \   00001D   49           ORL     A,R1
   \   00001E   70F3         JNZ     ??system_init_1
   \   000020   75C600       MOV     0xc6,#0x0
   \                     ??system_init_2:
   \   000023   E59E         MOV     A,0x9e
   \   000025   70FC         JNZ     ??system_init_2
   \   000027   43BE04       ORL     0xbe,#0x4
   \   00002A   906270       MOV     DPTR,#0x6270
   \   00002D   7408         MOV     A,#0x8
   \   00002F   F0           MOVX    @DPTR,A
   \   000030   D290         SETB    0x90.0
   \   000032   43FE01       ORL     0xfe,#0x1
   \   000035   D291         SETB    0x90.1
   \   000037   43FE02       ORL     0xfe,#0x2
   \   00003A   D292         SETB    0x90.2
   \   00003C   43FE04       ORL     0xfe,#0x4
   \   00003F   438F08       ORL     0x8f,#0x8
     16            vddWait(VDD_MIN_RUN);
   \   000042                ; Setup parameters for call to function vddWait
   \   000042   794A         MOV     R1,#0x4a
   \   000044   12....       LCALL   vddWait
     17            HAL_DMA_SET_ADDR_DESC0(&dmaCh0);                    // 用于flash的读写
                   ^
Warning[Pe069]: integer conversion resulted in truncation
   \   000047   74..         MOV     A,#(dmaCh0 >> 8) & 0xff
   \   000049   F5D5         MOV     0xd5,A
   \   00004B   75D4..       MOV     0xd4,#dmaCh0 & 0xff
     18            keyInit();                                          // 可以使用按键进入boot模式
   \   00004E                ; Setup parameters for call to function keyInit
   \   00004E   12....       LCALL   keyInit
     19            shell_hw_init(38400);
   \   000051                ; Setup parameters for call to function shell_hw_init
   \   000051   90....       MOV     DPTR,#__Constant_47160000
   \   000054   12....       LCALL   ?XLOAD_R2345
   \   000057   12....       LCALL   shell_hw_init
     20            /* 判断启动 APP 程序 */
     21            SYS_PARAMETER_READ;
   \   00005A                ; Setup parameters for call to function HalFlashRead
   \   00005A   75..02       MOV     ?V0,#0x2
   \   00005D   75..00       MOV     ?V1,#0x0
   \   000060   78..         MOV     R0,#?V0
   \   000062   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000065   7C..         MOV     R4,#sys_parameter & 0xff
   \   000067   7D..         MOV     R5,#(sys_parameter >> 8) & 0xff
   \   000069   7A00         MOV     R2,#0x0
   \   00006B   7B00         MOV     R3,#0x0
   \   00006D   7909         MOV     R1,#0x9
   \   00006F   12....       LCALL   HalFlashRead
   \   000072   7402         MOV     A,#0x2
   \   000074   12....       LCALL   ?DEALLOC_XSTACK8
     22            start_app_partition(sys_parameter.current_part);
   \   000077                ; Setup parameters for call to function start_app_partition
   \   000077   90....       MOV     DPTR,#sys_parameter
   \   00007A   E0           MOVX    A,@DPTR
   \   00007B   F9           MOV     R1,A
   \   00007C   12....       LCALL   start_app_partition
     23            
     24            /* 启动 boot程序和控制台 */
     25            shell_init("shell >" ,Uart0_Send_LenString);        // 初始化 控制台输出
   \   00007F                ; Setup parameters for call to function shell_init
   \   00007F   7C..         MOV     R4,#Uart0_Send_LenString & 0xff
   \   000081   7D..         MOV     R5,#(Uart0_Send_LenString >> 8) & 0xff
   \   000083   7A..         MOV     R2,#`?<Constant "shell >">` & 0xff
   \   000085   7B..         MOV     R3,#(`?<Constant "shell >">` >> 8) & 0xff
   \   000087   12....       LCALL   shell_init
     26            shell_input_init(&shell_1,Uart0_Send_LenString);    // 初始化 交互
   \   00008A                ; Setup parameters for call to function shell_input_init
   \   00008A   7C..         MOV     R4,#Uart0_Send_LenString & 0xff
   \   00008C   7D..         MOV     R5,#(Uart0_Send_LenString >> 8) & 0xff
   \   00008E   7A..         MOV     R2,#shell_1 & 0xff
   \   000090   7B..         MOV     R3,#(shell_1 >> 8) & 0xff
   \   000092   12....       LCALL   shell_input_init
     27            welcome_gets(&shell_1,0,0);                         // 主动显示 welcome
   \   000095                ; Setup parameters for call to function welcome_gets
   \   000095   E4           CLR     A
   \   000096   F5..         MOV     ?V0,A
   \   000098   78..         MOV     R0,#?V0
   \   00009A   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00009D   7C00         MOV     R4,#0x0
   \   00009F   7D00         MOV     R5,#0x0
   \   0000A1   7A..         MOV     R2,#shell_1 & 0xff
   \   0000A3   7B..         MOV     R3,#(shell_1 >> 8) & 0xff
   \   0000A5   12....       LCALL   welcome_gets
   \   0000A8   7402         MOV     A,#0x2
   \   0000AA   12....       LCALL   ?DEALLOC_XSTACK8
     28          
     29            /* shell 控制台进行用户输入 */
     30            cmdline_gets(&shell_1,"\r",1);                      // 一次换行
   \   0000AD                ; Setup parameters for call to function cmdline_gets
   \   0000AD   75..01       MOV     ?V0,#0x1
   \   0000B0   78..         MOV     R0,#?V0
   \   0000B2   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0000B5   7C..         MOV     R4,#`?<Constant "\\r">` & 0xff
   \   0000B7   7D..         MOV     R5,#(`?<Constant "\\r">` >> 8) & 0xff
   \   0000B9   7A..         MOV     R2,#shell_1 & 0xff
   \   0000BB   7B..         MOV     R3,#(shell_1 >> 8) & 0xff
   \   0000BD   12....       LCALL   cmdline_gets
   \   0000C0   7402         MOV     A,#0x2
   \   0000C2   12....       LCALL   ?DEALLOC_XSTACK8
     31          }
   \   0000C5   7F02         MOV     R7,#0x2
   \   0000C7   02....       LJMP    ?FUNC_LEAVE_XDATA
   \   0000CA                REQUIRE SLEEPCMD
   \   0000CA                REQUIRE SLEEPSTA
   \   0000CA                REQUIRE CLKCONCMD
   \   0000CA                REQUIRE CLKCONSTA
   \   0000CA                REQUIRE _A_P1
   \   0000CA                REQUIRE P1DIR
   \   0000CA                REQUIRE P0INP
   \   0000CA                REQUIRE DMA0CFGH
   \   0000CA                REQUIRE DMA0CFGL
     32          
     33          // APP初始化
     34          static void app_init()
     35          {
     36            led_init();
     37            register_user_cmd();
     38          }
     39          
     40          // 主函数

   \                                 In  segment NEAR_CODE, align 1, keep-with-next
     41          void main(void)
   \                     main:
     42          {
   \   000000                ; Auto size: 0
     43            system_init();
   \   000000                ; Setup parameters for call to function system_init
   \   000000   12....       LCALL   system_init
     44            app_init();
   \   000003                ; Setup parameters for call to function led_init
   \   000003   12....       LCALL   led_init
   \   000006                ; Setup parameters for call to function register_user_cmd
   \   000006   12....       LCALL   register_user_cmd
   \   000009   8003         SJMP    ??main_0
     45            while(1){
     46              led_app();
     47              shell_app_cycle();
     48              if(usart0_mode==0)                // 串口数据走向
     49                shell_app_cycle();
   \                     ??main_1:
   \   00000B                ; Setup parameters for call to function shell_app_cycle
   \   00000B   12....       LCALL   shell_app_cycle
   \                     ??main_0:
   \   00000E                ; Setup parameters for call to function led_app
   \   00000E   12....       LCALL   led_app
   \   000011                ; Setup parameters for call to function shell_app_cycle
   \   000011   12....       LCALL   shell_app_cycle
   \   000014   90....       MOV     DPTR,#usart0_mode
   \   000017   E0           MOVX    A,@DPTR
   \   000018   60F1         JZ      ??main_1
     50              else
     51                IAP_download();
   \   00001A                ; Setup parameters for call to function IAP_download
   \   00001A   12....       LCALL   IAP_download
   \   00001D   80EF         SJMP    ??main_0
     52            }
     53          }

   \                                 In  segment XDATA_ID, align 1, keep-with-next
   \                     `?<Initializer for <Constant "shell >">>`:
   \   000000   7368656C     DB "shell >"
   \            6C203E00

   \                                 In  segment XDATA_ID, align 1, keep-with-next
   \                     `?<Initializer for <Constant "\\r">>`:
   \   000000   0D00         DB "\015"

   \                                 In  segment XDATA_ID, align 1, keep-with-next
   \                     `?<Initializer for __Constant_47160000>`:
   \   000000   00001647     DD 47160000H

   \                                 In  segment XDATA_I, align 1, keep-with-next
   \                     `?<Constant "shell >">`:
   \   000000                DS 8
   \   000008                REQUIRE `?<Initializer for <Constant "shell >">>`
   \   000008                REQUIRE __INIT_XDATA_I

   \                                 In  segment XDATA_I, align 1, keep-with-next
   \                     `?<Constant "\\r">`:
   \   000000                DS 2
   \   000002                REQUIRE `?<Initializer for <Constant "\\r">>`
   \   000002                REQUIRE __INIT_XDATA_I

   \                                 In  segment XDATA_I, align 1, keep-with-next
   \                     __Constant_47160000:
   \   000000                DS 4
   \   000004                REQUIRE `?<Initializer for __Constant_47160000>`
   \   000004                REQUIRE __INIT_XDATA_I

   Maximum stack usage in bytes:

   XSTACK Function
   ------ --------
      0   main
        0   -> IAP_download
        0   -> led_app
        0   -> led_init
        0   -> register_user_cmd
        0   -> shell_app_cycle
        0   -> system_init
     11   system_init
       11   -> HalFlashRead
       11   -> cmdline_gets
        9   -> keyInit
        9   -> shell_hw_init
        9   -> shell_init
        9   -> shell_input_init
        9   -> start_app_partition
        9   -> vddWait
       11   -> welcome_gets


   Segment part sizes:

   Bytes  Function/Label
   -----  --------------
       2  ?<Constant "\r">
       8  ?<Constant "shell >">
       2  ?<Initializer for <Constant "\r">>
       8  ?<Initializer for <Constant "shell >">>
       4  ?<Initializer for __Constant_47160000>
       1  CLKCONCMD
       1  CLKCONSTA
       1  DMA0CFGH
       1  DMA0CFGL
       1  P0INP
       1  P1DIR
       1  SLEEPCMD
       1  SLEEPSTA
       1  _A_P1
       4  __Constant_47160000
       8  dmaCh0
      31  main
       2  sys_parameter
     202  system_init

 
 233 bytes in segment NEAR_CODE
   9 bytes in segment SFR_AN
  14 bytes in segment XDATA_I
  14 bytes in segment XDATA_ID
  10 bytes in segment XDATA_Z
 
 243 bytes of CODE  memory (+ 4 bytes shared)
   0 bytes of DATA  memory (+ 9 bytes shared)
  20 bytes of XDATA memory (+ 4 bytes shared)

Errors: none
Warnings: 1
