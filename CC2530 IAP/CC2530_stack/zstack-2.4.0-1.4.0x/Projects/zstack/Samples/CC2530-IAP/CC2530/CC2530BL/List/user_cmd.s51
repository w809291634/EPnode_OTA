///////////////////////////////////////////////////////////////////////////////
//
// IAR C/C++ Compiler V9.10.1.2146 for 8051               07/Jul/2023  16:40:19
// Copyright 2004-2014 IAR Systems AB.
// Standalone license - IAR Embedded Workbench for 8051
//
//    Core               =  plain
//    Code model         =  near
//    Data model         =  large
//    Calling convention =  xdata reentrant
//    Constant location  =  data
//    Dptr setup         =  1,16
//                          
//    Source file        =  
//        I:\1_git_code\EPnode_OTA\CC2530
//        IAP\CC2530_stack\zstack-2.4.0-1.4.0x\Projects\zstack\Samples\CC2530-IAP\Source\shell\user_cmd.c
//    Command line       =  
//        "I:\1_git_code\EPnode_OTA\CC2530
//        IAP\CC2530_stack\zstack-2.4.0-1.4.0x\Projects\zstack\Samples\CC2530-IAP\Source\shell\user_cmd.c"
//        -D HAL_SB_BOOT_CODE -D HAL_UART=TRUE -D HAL_UART_DMA=0 -D
//        HAL_UART_ISR=1 -D HAL_UART_ISR_RX_MAX=254 -lC
//        "I:\1_git_code\EPnode_OTA\CC2530
//        IAP\CC2530_stack\zstack-2.4.0-1.4.0x\Projects\zstack\Samples\CC2530-IAP\CC2530\CC2530BL\List\"
//        -lA "I:\1_git_code\EPnode_OTA\CC2530
//        IAP\CC2530_stack\zstack-2.4.0-1.4.0x\Projects\zstack\Samples\CC2530-IAP\CC2530\CC2530BL\List\"
//        --diag_suppress Pe001,Pa010,Pa050 -o "I:\1_git_code\EPnode_OTA\CC2530
//        IAP\CC2530_stack\zstack-2.4.0-1.4.0x\Projects\zstack\Samples\CC2530-IAP\CC2530\CC2530BL\Obj\"
//        -e --debug --core=plain --dptr=16,1 --data_model=large
//        --code_model=near --calling_convention=xdata_reentrant
//        --place_constants=data --nr_virtual_regs 8 -I
//        "I:\1_git_code\EPnode_OTA\CC2530
//        IAP\CC2530_stack\zstack-2.4.0-1.4.0x\Projects\zstack\Samples\CC2530-IAP\CC2530\..\Source\drive\"
//        -I "I:\1_git_code\EPnode_OTA\CC2530
//        IAP\CC2530_stack\zstack-2.4.0-1.4.0x\Projects\zstack\Samples\CC2530-IAP\CC2530\..\Source\iap\"
//        -I "I:\1_git_code\EPnode_OTA\CC2530
//        IAP\CC2530_stack\zstack-2.4.0-1.4.0x\Projects\zstack\Samples\CC2530-IAP\CC2530\..\Source\shell\"
//        -I "I:\1_git_code\EPnode_OTA\CC2530
//        IAP\CC2530_stack\zstack-2.4.0-1.4.0x\Projects\zstack\Samples\CC2530-IAP\CC2530\..\Source\sys\"
//        -I "I:\1_git_code\EPnode_OTA\CC2530
//        IAP\CC2530_stack\zstack-2.4.0-1.4.0x\Projects\zstack\Samples\CC2530-IAP\CC2530\..\Source\"
//        -I "I:\1_git_code\EPnode_OTA\CC2530
//        IAP\CC2530_stack\zstack-2.4.0-1.4.0x\Projects\zstack\Samples\CC2530-IAP\CC2530\source\"
//        -I "I:\1_git_code\EPnode_OTA\CC2530
//        IAP\CC2530_stack\zstack-2.4.0-1.4.0x\Projects\zstack\Samples\CC2530-IAP\CC2530\..\..\common\"
//        -I "I:\1_git_code\EPnode_OTA\CC2530
//        IAP\CC2530_stack\zstack-2.4.0-1.4.0x\Projects\zstack\Samples\CC2530-IAP\CC2530\..\..\..\ZMain\TI2530DB\"
//        -I "I:\1_git_code\EPnode_OTA\CC2530
//        IAP\CC2530_stack\zstack-2.4.0-1.4.0x\Projects\zstack\Samples\CC2530-IAP\CC2530\..\..\..\..\..\Components\hal\include\"
//        -I "I:\1_git_code\EPnode_OTA\CC2530
//        IAP\CC2530_stack\zstack-2.4.0-1.4.0x\Projects\zstack\Samples\CC2530-IAP\CC2530\..\..\..\..\..\Components\hal\target\_COMMON\CC2530\"
//        -I "I:\1_git_code\EPnode_OTA\CC2530
//        IAP\CC2530_stack\zstack-2.4.0-1.4.0x\Projects\zstack\Samples\CC2530-IAP\CC2530\..\..\..\..\..\Components\hal\target\CC2530EB\"
//        -I "I:\1_git_code\EPnode_OTA\CC2530
//        IAP\CC2530_stack\zstack-2.4.0-1.4.0x\Projects\zstack\Samples\CC2530-IAP\CC2530\..\..\..\..\..\Components\osal\include\"
//        -I "I:\1_git_code\EPnode_OTA\CC2530
//        IAP\CC2530_stack\zstack-2.4.0-1.4.0x\Projects\zstack\Samples\CC2530-IAP\CC2530\..\..\..\..\..\Components\services\saddr\"
//        -Ohz
//    List file          =  
//        I:\1_git_code\EPnode_OTA\CC2530
//        IAP\CC2530_stack\zstack-2.4.0-1.4.0x\Projects\zstack\Samples\CC2530-IAP\CC2530\CC2530BL\List\user_cmd.s51
//
///////////////////////////////////////////////////////////////////////////////

        NAME user_cmd

        RTMODEL "__SystemLibrary", "CLib"
        RTMODEL "__calling_convention", "xdata_reentrant"
        RTMODEL "__code_model", "near"
        RTMODEL "__core", "plain"
        RTMODEL "__data_model", "large"
        RTMODEL "__dptr_size", "16"
        RTMODEL "__extended_stack", "disabled"
        RTMODEL "__iar_require _formatted_write", ""
        RTMODEL "__location_for_constants", "data"
        RTMODEL "__number_of_dptrs", "1"
        RTMODEL "__rt_version", "1"

        RSEG DOVERLAY:DATA:NOROOT(0)
        RSEG IOVERLAY:IDATA:NOROOT(0)
        RSEG ISTACK:IDATA:NOROOT(0)
        RSEG PSTACK:XDATA:NOROOT(0)
        RSEG XSTACK:XDATA:NOROOT(0)

        EXTERN ?V0
        EXTERN ?V1
        EXTERN ?ALLOC_XSTACK8
        EXTERN ?DEALLOC_XSTACK8
        EXTERN ?FUNC_ENTER_XDATA
        EXTERN ?FUNC_LEAVE_XDATA
        EXTERN ?PUSH_XSTACK_I_TWO
        EXTERN ?XSTACK_DISP0_8
        EXTERN ?XSTACK_DISP102_8
        EXTERN __INIT_XDATA_I
        EXTERN __INIT_XDATA_Z

        PUBLIC SoftReset
        FUNCTION SoftReset,0603H
        ARGFRAME XSTACK, 0, STACK
        PUBWEAK WDCTL
        PUBWEAK _A_IEN0
        PUBLIC __IAP
        FUNCTION __IAP,0a1603H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME XSTACK, 15, STACK
        PUBLIC iap_mode_confirm
        FUNCTION iap_mode_confirm,021603H
        ARGFRAME XSTACK, 0, STACK
        PUBLIC register_user_cmd
        FUNCTION register_user_cmd,0a1203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME XSTACK, 11, STACK
        
          CFI Names cfiNames0
          CFI StackFrame CFA_SP SP IDATA
          CFI StackFrame CFA_PSP16 PSP16 XDATA
          CFI StackFrame CFA_XSP16 XSP16 XDATA
          CFI StaticOverlayFrame CFA_IOVERLAY IOVERLAY
          CFI StaticOverlayFrame CFA_DOVERLAY DOVERLAY
          CFI Resource `PSW.CY`:1, `B.BR0`:1, `B.BR1`:1, `B.BR2`:1, `B.BR3`:1
          CFI Resource `B.BR4`:1, `B.BR5`:1, `B.BR6`:1, `B.BR7`:1, `VB.BR8`:1
          CFI Resource `VB.BR9`:1, `VB.BR10`:1, `VB.BR11`:1, `VB.BR12`:1
          CFI Resource `VB.BR13`:1, `VB.BR14`:1, `VB.BR15`:1, VB:8, B:8, A:8
          CFI Resource PSW:8, DPL0:8, DPH0:8, R0:8, R1:8, R2:8, R3:8, R4:8, R5:8
          CFI Resource R6:8, R7:8, V0:8, V1:8, V2:8, V3:8, V4:8, V5:8, V6:8, V7:8
          CFI Resource SP:8, PSPH:8, PSPL:8, PSP16:16, XSPH:8, XSPL:8, XSP16:16
          CFI VirtualResource ?RET:16, ?RET_HIGH:8, ?RET_LOW:8
          CFI ResourceParts PSP16 PSPH, PSPL
          CFI ResourceParts XSP16 XSPH, XSPL
          CFI ResourceParts ?RET ?RET_HIGH, ?RET_LOW
          CFI EndNames cfiNames0
        
          CFI Common cfiCommon0 Using cfiNames0
          CFI CodeAlign 1
          CFI DataAlign -1
          CFI ReturnAddress ?RET CODE
          CFI CFA_DOVERLAY Used
          CFI CFA_IOVERLAY Used
          CFI CFA_SP SP+-2
          CFI CFA_PSP16 PSP16+0
          CFI CFA_XSP16 XSP16+0
          CFI `PSW.CY` SameValue
          CFI `B.BR0` SameValue
          CFI `B.BR1` SameValue
          CFI `B.BR2` SameValue
          CFI `B.BR3` SameValue
          CFI `B.BR4` SameValue
          CFI `B.BR5` SameValue
          CFI `B.BR6` SameValue
          CFI `B.BR7` SameValue
          CFI `VB.BR8` SameValue
          CFI `VB.BR9` SameValue
          CFI `VB.BR10` SameValue
          CFI `VB.BR11` SameValue
          CFI `VB.BR12` SameValue
          CFI `VB.BR13` SameValue
          CFI `VB.BR14` SameValue
          CFI `VB.BR15` SameValue
          CFI VB SameValue
          CFI B Undefined
          CFI A Undefined
          CFI PSW SameValue
          CFI DPL0 SameValue
          CFI DPH0 SameValue
          CFI R0 Undefined
          CFI R1 Undefined
          CFI R2 Undefined
          CFI R3 Undefined
          CFI R4 Undefined
          CFI R5 Undefined
          CFI R6 SameValue
          CFI R7 SameValue
          CFI V0 SameValue
          CFI V1 SameValue
          CFI V2 SameValue
          CFI V3 SameValue
          CFI V4 SameValue
          CFI V5 SameValue
          CFI V6 SameValue
          CFI V7 SameValue
          CFI PSPH Undefined
          CFI PSPL Undefined
          CFI XSPH Undefined
          CFI XSPL Undefined
          CFI ?RET Concat
          CFI ?RET_HIGH Frame(CFA_SP, 2)
          CFI ?RET_LOW Frame(CFA_SP, 1)
          CFI EndCommon cfiCommon0
        
        EXTERN _shell_register
        FUNCTION _shell_register,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 11, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN cmdline_strtok
        FUNCTION cmdline_strtok,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 15, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN printf
        FUNCTION printf,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 15, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN strstr
        FUNCTION strstr,010202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 13, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN sys_parameter
        EXTERN usart0_mode
        EXTERN write_sys_parameter
        FUNCTION write_sys_parameter,0200H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 13, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC

// I:\1_git_code\EPnode_OTA\CC2530 IAP\CC2530_stack\zstack-2.4.0-1.4.0x\Projects\zstack\Samples\CC2530-IAP\Source\shell\user_cmd.c
//    1 #include "user_cmd.h"

        ASEGN SFR_AN:DATA:NOROOT,0a8H
// union <unnamed> volatile __sfr _A_IEN0
_A_IEN0:
        DATA8
        DS 1

        ASEGN SFR_AN:DATA:NOROOT,0c9H
// unsigned char volatile __sfr WDCTL
WDCTL:
        DATA8
        DS 1
//    2 #include "shell.h"
//    3 #include "uart.h"
//    4 #include "iap_config.h"
//    5 #include "sys.h"
//    6 #include "hal_flash.h"
//    7 #include "download.h"
//    8 

        RSEG NEAR_CODE:CODE:NOROOT(0)
//    9 void SoftReset(void* arg)
SoftReset:
          CFI Block cfiBlock0 Using cfiCommon0
          CFI Function SoftReset
        CODE
//   10 { 
        ; Saved register size: 0
        ; Auto size: 0
//   11   (void)arg;
//   12   HAL_SYSTEM_RESET();
        CLR     0xa8.7
        MOV     0xc9,#-0x55
        MOV     0xc9,#0x5b
??SoftReset_0:
        SJMP    ??SoftReset_0
          CFI EndBlock cfiBlock0
        REQUIRE _A_IEN0
        REQUIRE WDCTL
//   13 }
//   14 
//   15 // 启动 IAP 模式

        RSEG NEAR_CODE:CODE:NOROOT(0)
//   16 void __IAP(void * arg)
__IAP:
          CFI Block cfiBlock1 Using cfiCommon0
          CFI Function __IAP
        CODE
//   17 {
        FUNCALL __IAP, cmdline_strtok
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 15, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 15, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL __IAP, printf
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 15, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 15, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL __IAP, strstr
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 13, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 13, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL __IAP, strstr
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 13, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 13, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL __IAP, write_sys_parameter
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 13, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 13, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL __IAP, printf
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 15, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 15, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        REQUIRE ?V0
        REQUIRE ?V1
        MOV     A,#-0x9
        LCALL   ?FUNC_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 9)
        ; Saved register size: 9
        ; Auto size: 4
        MOV     A,#-0x4
        LCALL   ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 13)
//   18   char * argv[2];
//   19   int argc =cmdline_strtok((char*)arg,argv,2);
//   20   if(argc<2){
        ; Setup parameters for call to function cmdline_strtok
        MOV     ?V0,#0x2
        MOV     ?V1,#0x0
        MOV     R0,#?V0
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 15)
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP102_8
        LCALL   cmdline_strtok
        MOV     A,#0x2
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 13)
        CLR     C
        MOV     A,R2
        SUBB    A,#0x2
        MOV     A,R3
        SUBB    A,#0x0
        MOV     C,0xD0 /* PSW */.2
        XRL     A,PSW
        RLC     A
        JC      ??__IAP_0
//   21     debug_info(INFO"please input %s [<update> or <exit>] \r\n",IAP_CMD);
        ; Setup parameters for call to function printf
//   22     return;
//   23   }
//   24   if(strstr(argv[1],"update")){
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP0_8
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R1,A
        MOV     DPL,R0
        MOV     DPH,R1
        ; Setup parameters for call to function strstr
        MOV     R4,#`?<Constant "update">` & 0xff
        MOV     R5,#(`?<Constant "update">` >> 8) & 0xff
        MOV     R2,DPL
        MOV     R3,DPH
        LCALL   strstr
        MOV     ?V1,R3
        MOV     A,R2
        ORL     A,?V1
        JZ      ??__IAP_1
//   25     usart0_mode=1;
        MOV     DPTR,#usart0_mode
        MOV     A,#0x1
        MOVX    @DPTR,A
        SJMP    ??__IAP_2
//   26   }else if(strstr(argv[1],"exit")){
??__IAP_1:
        ; Setup parameters for call to function strstr
        MOV     R4,#`?<Constant "exit">` & 0xff
        MOV     R5,#(`?<Constant "exit">` >> 8) & 0xff
        MOV     R2,DPL
        MOV     R3,DPH
        LCALL   strstr
        MOV     ?V1,R3
        MOV     A,R2
        ORL     A,?V1
        JZ      ??__IAP_0
//   27     sys_parameter.current_part=1;
        MOV     DPTR,#sys_parameter
        MOV     A,#0x1
        MOVX    @DPTR,A
//   28     write_sys_parameter(); 
        ; Setup parameters for call to function write_sys_parameter
        LCALL   write_sys_parameter
//   29     HAL_SYSTEM_RESET();
        CLR     0xa8.7
        MOV     0xc9,#-0x55
        MOV     0xc9,#0x5b
??__IAP_3:
        SJMP    ??__IAP_3
//   30   }else{
//   31     debug_info(INFO"please input %s [<update> or <exit>] \r\n",IAP_CMD);
??__IAP_0:
        ; Setup parameters for call to function printf
        MOV     ?V0,#`?<Constant "IAP">` & 0xff
        MOV     ?V1,#(`?<Constant "IAP">` >> 8) & 0xff
        MOV     R0,#?V0
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 15)
        MOV     R2,#`?<Constant "INFORMATION:please in...">` & 0xff
        MOV     R3,#(`?<Constant "INFORMATION:please in...">` >> 8) & 0xff
        LCALL   printf
        MOV     A,#0x2
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 13)
//   32   }
//   33 }
??__IAP_2:
        MOV     A,#0x4
          CFI EndBlock cfiBlock1
        REQUIRE ?Subroutine0
        REQUIRE _A_IEN0
        REQUIRE WDCTL
        ; // Fall through to label ?Subroutine0

        RSEG NEAR_CODE:CODE:NOROOT(0)
?Subroutine0:
          CFI Block cfiBlock2 Using cfiCommon0
          CFI NoFunction
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 13)
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI Invalid
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 9)
          CFI Valid
        MOV     R7,#0x2
        LJMP    ?FUNC_LEAVE_XDATA
          CFI EndBlock cfiBlock2
//   34 
//   35 // 确认进入IAP

        RSEG NEAR_CODE:CODE:NOROOT(0)
//   36 void iap_mode_confirm(void * arg){
iap_mode_confirm:
          CFI Block cfiBlock3 Using cfiCommon0
          CFI Function iap_mode_confirm
        CODE
        FUNCALL iap_mode_confirm, printf
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 0, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 0, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        ; Saved register size: 0
        ; Auto size: 0
//   37   printf("OK\r\n");
        ; Setup parameters for call to function printf
        MOV     R2,#`?<Constant "OK\\r\\n">` & 0xff
        MOV     R3,#(`?<Constant "OK\\r\\n">` >> 8) & 0xff
        LJMP    printf
          CFI EndBlock cfiBlock3
//   38 }
//   39 
//   40 // 用户命令注册

        RSEG NEAR_CODE:CODE:NOROOT(0)
//   41 void register_user_cmd()
register_user_cmd:
          CFI Block cfiBlock4 Using cfiCommon0
          CFI Function register_user_cmd
        CODE
//   42 {
        FUNCALL register_user_cmd, _shell_register
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 11, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 11, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL register_user_cmd, _shell_register
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 11, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 11, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL register_user_cmd, _shell_register
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 11, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 11, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        REQUIRE ?V0
        REQUIRE ?V1
        MOV     A,#-0x9
        LCALL   ?FUNC_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 9)
        ; Saved register size: 9
        ; Auto size: 0
//   43   shell_register_command("reboot",SoftReset);
        ; Setup parameters for call to function _shell_register
        MOV     ?V0,#SoftReset & 0xff
        MOV     ?V1,#(SoftReset >> 8) & 0xff
        MOV     R0,#?V0
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 11)
        MOV     R4,#`?<Constant "reboot">` & 0xff
        MOV     R5,#(`?<Constant "reboot">` >> 8) & 0xff
        MOV     R2,#??newcmd & 0xff
        MOV     R3,#(??newcmd >> 8) & 0xff
        LCALL   _shell_register
        MOV     A,#0x2
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 9)
//   44   shell_register_command(IAP_CMD,__IAP);
        ; Setup parameters for call to function _shell_register
        MOV     ?V0,#__IAP & 0xff
        MOV     ?V1,#(__IAP >> 8) & 0xff
        MOV     R0,#?V0
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 11)
        MOV     R4,#`?<Constant "IAP">` & 0xff
        MOV     R5,#(`?<Constant "IAP">` >> 8) & 0xff
        MOV     R2,#??newcmd_1 & 0xff
        MOV     R3,#(??newcmd_1 >> 8) & 0xff
        LCALL   _shell_register
        MOV     A,#0x2
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 9)
//   45   shell_register_command("AT+IAP=IAP",iap_mode_confirm);
        ; Setup parameters for call to function _shell_register
        MOV     ?V0,#iap_mode_confirm & 0xff
        MOV     ?V1,#(iap_mode_confirm >> 8) & 0xff
        MOV     R0,#?V0
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 11)
        MOV     R4,#`?<Constant "AT+IAP=IAP">` & 0xff
        MOV     R5,#(`?<Constant "AT+IAP=IAP">` >> 8) & 0xff
        MOV     R2,#??newcmd_2 & 0xff
        MOV     R3,#(??newcmd_2 >> 8) & 0xff
        LCALL   _shell_register
        MOV     A,#0x2
        SJMP    ?Subroutine0
          CFI EndBlock cfiBlock4
//   46 }

        RSEG XDATA_Z:XDATA:NOROOT(0)
        DATA8
??newcmd:
        DS 10
        REQUIRE __INIT_XDATA_Z

        RSEG XDATA_Z:XDATA:NOROOT(0)
        DATA8
??newcmd_1:
        DS 10
        REQUIRE __INIT_XDATA_Z

        RSEG XDATA_Z:XDATA:NOROOT(0)
        DATA8
??newcmd_2:
        DS 10
        REQUIRE __INIT_XDATA_Z

        RSEG XDATA_ID:CODE:NOROOT(0)
`?<Initializer for <Constant "INFORMATION:pleas`:
        DB 49H, 4EH, 46H, 4FH, 52H, 4DH, 41H, 54H
        DB 49H, 4FH, 4EH, 3AH, 70H, 6CH, 65H, 61H
        DB 73H, 65H, 20H, 69H, 6EH, 70H, 75H, 74H
        DB 20H, 25H, 73H, 20H, 5BH, 3CH, 75H, 70H
        DB 64H, 61H, 74H, 65H, 3EH, 20H, 6FH, 72H
        DB 20H, 3CH, 65H, 78H, 69H, 74H, 3EH, 5DH
        DB 20H, 0DH, 0AH, 0

        RSEG XDATA_ID:CODE:NOROOT(0)
`?<Initializer for <Constant "IAP">>`:
        DB "IAP"

        RSEG XDATA_ID:CODE:NOROOT(0)
`?<Initializer for <Constant "update">>`:
        DB "update"

        RSEG XDATA_ID:CODE:NOROOT(0)
`?<Initializer for <Constant "exit">>`:
        DB "exit"

        RSEG XDATA_ID:CODE:NOROOT(0)
`?<Initializer for <Constant "OK\\r\\n">>`:
        DB "OK\015\012"

        RSEG XDATA_ID:CODE:NOROOT(0)
`?<Initializer for <Constant "reboot">>`:
        DB "reboot"

        RSEG XDATA_ID:CODE:NOROOT(0)
`?<Initializer for <Constant "AT+IAP=IAP">>`:
        DB "AT+IAP=IAP"

        RSEG XDATA_I:XDATA:NOROOT(0)
        DATA8
`?<Constant "INFORMATION:please in...">`:
        DS 52
        REQUIRE `?<Initializer for <Constant "INFORMATION:pleas`
        REQUIRE __INIT_XDATA_I

        RSEG XDATA_I:XDATA:NOROOT(0)
        DATA32
`?<Constant "IAP">`:
        DS 4
        REQUIRE `?<Initializer for <Constant "IAP">>`
        REQUIRE __INIT_XDATA_I

        RSEG XDATA_I:XDATA:NOROOT(0)
        DATA8
`?<Constant "update">`:
        DS 7
        REQUIRE `?<Initializer for <Constant "update">>`
        REQUIRE __INIT_XDATA_I

        RSEG XDATA_I:XDATA:NOROOT(0)
        DATA8
`?<Constant "exit">`:
        DS 5
        REQUIRE `?<Initializer for <Constant "exit">>`
        REQUIRE __INIT_XDATA_I

        RSEG XDATA_I:XDATA:NOROOT(0)
        DATA8
`?<Constant "OK\\r\\n">`:
        DS 5
        REQUIRE `?<Initializer for <Constant "OK\\r\\n">>`
        REQUIRE __INIT_XDATA_I

        RSEG XDATA_I:XDATA:NOROOT(0)
        DATA8
`?<Constant "reboot">`:
        DS 7
        REQUIRE `?<Initializer for <Constant "reboot">>`
        REQUIRE __INIT_XDATA_I

        RSEG XDATA_I:XDATA:NOROOT(0)
        DATA8
`?<Constant "AT+IAP=IAP">`:
        DS 11
        REQUIRE `?<Initializer for <Constant "AT+IAP=IAP">>`
        REQUIRE __INIT_XDATA_I

        END
// 
// 260 bytes in segment NEAR_CODE
//   2 bytes in segment SFR_AN
//  91 bytes in segment XDATA_I
//  91 bytes in segment XDATA_ID
//  30 bytes in segment XDATA_Z
// 
// 351 bytes of CODE  memory
//   0 bytes of DATA  memory (+ 2 bytes shared)
// 121 bytes of XDATA memory
//
//Errors: none
//Warnings: none
