/*********************************************************************************************
* 文件：timer.h
* 作者：Meixin 2017.09.27
* 说明：定时器驱动代码 
* 修改：
* 注释：
*********************************************************************************************/

/*********************************************************************************************
* 头文件
*********************************************************************************************/
#include "timer.h"

/*********************************************************************************************
* 名称：time1_init()
* 功能：定时器1初始化
* 参数：无
* 返回：无
* 修改：
* 注释：
*********************************************************************************************/
void time1_init(void)
{
  P2DIR |= 0x80;                                                //设置定时器1通道1为第一优先级
  P0SEL |= 0x08;                                                //配置管脚为外设模式
  P0DIR |= 0x08;                                                //配置控制管脚为输出模式
  T1CTL  = 0x02;                                                //定时器1 控制和状态 0000 0010,250KHz不分频，模模式   
  
  T1CCTL1 = 0x1C;                                               //定时器1 通道1 捕获/比较控制  比较相等置1，计数器回0则清零
  
  T1CC0H = 0x00;                                                //定时器1 通道0 捕获/比较值高位
  T1CC0L = 0xFA;                                                //定时器1 通道0 捕获/比较值低位 PWM信号的周期为1ms，频率为1KHz
  
  T1CC1H = 0x00;                                                //装定时器1 通道1 初值
  T1CC1L = 0x01;                                                //在此处设置通道2比较寄存器初值，让人眼看不到瞬间复位时灯的突闪
  }