///////////////////////////////////////////////////////////////////////////////
//
// IAR C/C++ Compiler V9.10.1.2146 for 8051               07/Jul/2023  16:40:48
// Copyright 2004-2014 IAR Systems AB.
// Standalone license - IAR Embedded Workbench for 8051
//
//    Core               =  plain
//    Code model         =  banked
//    Data model         =  large
//    Calling convention =  xdata reentrant
//    Constant location  =  data_rom
//    Dptr setup         =  1,16
//                          
//    Source file        =  
//        I:\1_git_code\EPnode_OTA\CC2530
//        IAP\CC2530_stack\zstack-2.4.0-1.4.0x\Projects\zstack\Samples\common\zxbee.c
//    Command line       =  
//        -f "I:\1_git_code\EPnode_OTA\CC2530
//        IAP\CC2530_stack\zstack-2.4.0-1.4.0x\Projects\zstack\Samples\CC2530-Serial(IAP)\CC2530DB\..\..\..\Tools\CC2530DB\f8wRouter.cfg"
//        (-DCPU32MHZ -DROOT=__near_func -DMAC_CFG_APP_PENDING_QUEUE=TRUE
//        -DMAC_CFG_TX_DATA_MAX=5 -DMAC_CFG_TX_MAX=8 -DMAC_CFG_RX_MAX=5
//        -DRTR_NWK) -f "I:\1_git_code\EPnode_OTA\CC2530
//        IAP\CC2530_stack\zstack-2.4.0-1.4.0x\Projects\zstack\Samples\CC2530-Serial(IAP)\CC2530DB\..\..\..\Tools\CC2530DB\f8wConfig.cfg"
//        (-DZIGBEEPRO -DSECURE=0 -DZG_SECURE_DYNAMIC=0 -DREFLECTOR
//        -DDEFAULT_CHANLIST=0x00000800 -DZDAPP_CONFIG_PAN_ID=8448
//        -DNWK_START_DELAY=100 -DEXTENDED_JOINING_RANDOM_MASK=0x007F
//        -DBEACON_REQUEST_DELAY=100 -DBEACON_REQ_DELAY_MASK=0x00FF
//        -DLINK_STATUS_JITTER_MASK=0x007F -DROUTE_EXPIRY_TIME=30
//        -DAPSC_ACK_WAIT_DURATION_POLLED=3000 -DNWK_INDIRECT_MSG_TIMEOUT=7
//        -DMAX_RREQ_ENTRIES=8 -DAPSC_MAX_FRAME_RETRIES=3
//        -DNWK_MAX_DATA_RETRIES=2 -DMAX_POLL_FAILURE_RETRIES=2 -DMAX_BCAST=9
//        -DAPS_MAX_GROUPS=16 -DMAX_RTG_ENTRIES=40 -DNWK_MAX_BINDING_ENTRIES=4
//        -DMAX_BINDING_CLUSTER_IDS=4 "-DDEFAULT_KEY={0x01, 0x03, 0x05, 0x07,
//        0x09, 0x0B, 0x0D, 0x0F, 0x00, 0x02, 0x04, 0x06, 0x08, 0x0A, 0x0C,
//        0x0D}" -DMAC_MAX_FRAME_SIZE=116 -DZDNWKMGR_MIN_TRANSMISSIONS=20
//        "-DCONST=const __code" -DGENERIC=__generic -DRFD_RCVC_ALWAYS_ON=TRUE
//        -DPOLL_RATE=1000 -DQUEUED_POLL_RATE=100 -DRESPONSE_POLL_RATE=100)
//        -DREJOIN_POLL_RATE=440 "I:\1_git_code\EPnode_OTA\CC2530
//        IAP\CC2530_stack\zstack-2.4.0-1.4.0x\Projects\zstack\Samples\common\zxbee.c"
//        -D HOLD_AUTO_START -D BUILD_ALL_DEVICES -D REFLECTOR -D NV_INIT -D
//        XLAB -D CC2530_Serial -D MAKE_CRC_SHDW -D CC2530_USE_IAP -lC
//        "I:\1_git_code\EPnode_OTA\CC2530
//        IAP\CC2530_stack\zstack-2.4.0-1.4.0x\Projects\zstack\Samples\CC2530-Serial(IAP)\CC2530DB\CC2530-Serial\List\"
//        -lA "I:\1_git_code\EPnode_OTA\CC2530
//        IAP\CC2530_stack\zstack-2.4.0-1.4.0x\Projects\zstack\Samples\CC2530-Serial(IAP)\CC2530DB\CC2530-Serial\List\"
//        --diag_suppress Pe001,Pa010 -o "I:\1_git_code\EPnode_OTA\CC2530
//        IAP\CC2530_stack\zstack-2.4.0-1.4.0x\Projects\zstack\Samples\CC2530-Serial(IAP)\CC2530DB\CC2530-Serial\Obj\"
//        -e --no_cse --no_unroll --no_inline --no_code_motion --no_tbaa
//        --debug --core=plain --dptr=16,1 --data_model=large
//        --code_model=banked --calling_convention=xdata_reentrant
//        --place_constants=data_rom --nr_virtual_regs 8 -I
//        "I:\1_git_code\EPnode_OTA\CC2530
//        IAP\CC2530_stack\zstack-2.4.0-1.4.0x\Projects\zstack\Samples\CC2530-Serial(IAP)\CC2530DB\"
//        -I "I:\1_git_code\EPnode_OTA\CC2530
//        IAP\CC2530_stack\zstack-2.4.0-1.4.0x\Projects\zstack\Samples\CC2530-Serial(IAP)\CC2530DB\..\Source\"
//        -I "I:\1_git_code\EPnode_OTA\CC2530
//        IAP\CC2530_stack\zstack-2.4.0-1.4.0x\Projects\zstack\Samples\CC2530-Serial(IAP)\CC2530DB\..\..\common\"
//        -I "I:\1_git_code\EPnode_OTA\CC2530
//        IAP\CC2530_stack\zstack-2.4.0-1.4.0x\Projects\zstack\Samples\CC2530-Serial(IAP)\CC2530DB\..\..\..\ZMain\TI2530DB\"
//        -I "I:\1_git_code\EPnode_OTA\CC2530
//        IAP\CC2530_stack\zstack-2.4.0-1.4.0x\Projects\zstack\Samples\CC2530-Serial(IAP)\CC2530DB\..\..\..\..\..\Components\hal\include\"
//        -I "I:\1_git_code\EPnode_OTA\CC2530
//        IAP\CC2530_stack\zstack-2.4.0-1.4.0x\Projects\zstack\Samples\CC2530-Serial(IAP)\CC2530DB\..\..\..\..\..\Components\hal\target\CC2530EB\"
//        -I "I:\1_git_code\EPnode_OTA\CC2530
//        IAP\CC2530_stack\zstack-2.4.0-1.4.0x\Projects\zstack\Samples\CC2530-Serial(IAP)\CC2530DB\..\..\..\..\..\Components\mac\include\"
//        -I "I:\1_git_code\EPnode_OTA\CC2530
//        IAP\CC2530_stack\zstack-2.4.0-1.4.0x\Projects\zstack\Samples\CC2530-Serial(IAP)\CC2530DB\..\..\..\..\..\Components\mac\high_level\"
//        -I "I:\1_git_code\EPnode_OTA\CC2530
//        IAP\CC2530_stack\zstack-2.4.0-1.4.0x\Projects\zstack\Samples\CC2530-Serial(IAP)\CC2530DB\..\..\..\..\..\Components\mac\low_level\srf04\"
//        -I "I:\1_git_code\EPnode_OTA\CC2530
//        IAP\CC2530_stack\zstack-2.4.0-1.4.0x\Projects\zstack\Samples\CC2530-Serial(IAP)\CC2530DB\..\..\..\..\..\Components\mac\low_level\srf04\single_chip\"
//        -I "I:\1_git_code\EPnode_OTA\CC2530
//        IAP\CC2530_stack\zstack-2.4.0-1.4.0x\Projects\zstack\Samples\CC2530-Serial(IAP)\CC2530DB\..\..\..\..\..\Components\mt\"
//        -I "I:\1_git_code\EPnode_OTA\CC2530
//        IAP\CC2530_stack\zstack-2.4.0-1.4.0x\Projects\zstack\Samples\CC2530-Serial(IAP)\CC2530DB\..\..\..\..\..\Components\osal\include\"
//        -I "I:\1_git_code\EPnode_OTA\CC2530
//        IAP\CC2530_stack\zstack-2.4.0-1.4.0x\Projects\zstack\Samples\CC2530-Serial(IAP)\CC2530DB\..\..\..\..\..\Components\osal\mcu\ccsoc\"
//        -I "I:\1_git_code\EPnode_OTA\CC2530
//        IAP\CC2530_stack\zstack-2.4.0-1.4.0x\Projects\zstack\Samples\CC2530-Serial(IAP)\CC2530DB\..\..\..\..\..\Components\services\saddr\"
//        -I "I:\1_git_code\EPnode_OTA\CC2530
//        IAP\CC2530_stack\zstack-2.4.0-1.4.0x\Projects\zstack\Samples\CC2530-Serial(IAP)\CC2530DB\..\..\..\..\..\Components\services\sdata\"
//        -I "I:\1_git_code\EPnode_OTA\CC2530
//        IAP\CC2530_stack\zstack-2.4.0-1.4.0x\Projects\zstack\Samples\CC2530-Serial(IAP)\CC2530DB\..\..\..\..\..\Components\stack\af\"
//        -I "I:\1_git_code\EPnode_OTA\CC2530
//        IAP\CC2530_stack\zstack-2.4.0-1.4.0x\Projects\zstack\Samples\CC2530-Serial(IAP)\CC2530DB\..\..\..\..\..\Components\stack\nwk\"
//        -I "I:\1_git_code\EPnode_OTA\CC2530
//        IAP\CC2530_stack\zstack-2.4.0-1.4.0x\Projects\zstack\Samples\CC2530-Serial(IAP)\CC2530DB\..\..\..\..\..\Components\stack\sapi\"
//        -I "I:\1_git_code\EPnode_OTA\CC2530
//        IAP\CC2530_stack\zstack-2.4.0-1.4.0x\Projects\zstack\Samples\CC2530-Serial(IAP)\CC2530DB\..\..\..\..\..\Components\stack\sec\"
//        -I "I:\1_git_code\EPnode_OTA\CC2530
//        IAP\CC2530_stack\zstack-2.4.0-1.4.0x\Projects\zstack\Samples\CC2530-Serial(IAP)\CC2530DB\..\..\..\..\..\Components\stack\sys\"
//        -I "I:\1_git_code\EPnode_OTA\CC2530
//        IAP\CC2530_stack\zstack-2.4.0-1.4.0x\Projects\zstack\Samples\CC2530-Serial(IAP)\CC2530DB\..\..\..\..\..\Components\stack\zdo\"
//        -I "I:\1_git_code\EPnode_OTA\CC2530
//        IAP\CC2530_stack\zstack-2.4.0-1.4.0x\Projects\zstack\Samples\CC2530-Serial(IAP)\CC2530DB\..\..\..\..\..\Components\zmac\"
//        -I "I:\1_git_code\EPnode_OTA\CC2530
//        IAP\CC2530_stack\zstack-2.4.0-1.4.0x\Projects\zstack\Samples\CC2530-Serial(IAP)\CC2530DB\..\..\..\..\..\Components\zmac\f8w\"
//        -On
//    List file          =  
//        I:\1_git_code\EPnode_OTA\CC2530
//        IAP\CC2530_stack\zstack-2.4.0-1.4.0x\Projects\zstack\Samples\CC2530-Serial(IAP)\CC2530DB\CC2530-Serial\List\zxbee.s51
//
///////////////////////////////////////////////////////////////////////////////

        NAME zxbee

        RTMODEL "__SystemLibrary", "CLib"
        RTMODEL "__calling_convention", "xdata_reentrant"
        RTMODEL "__code_model", "banked"
        RTMODEL "__core", "plain"
        RTMODEL "__data_model", "large"
        RTMODEL "__dptr_size", "16"
        RTMODEL "__extended_stack", "disabled"
        RTMODEL "__iar_require _formatted_write", ""
        RTMODEL "__location_for_constants", "data"
        RTMODEL "__number_of_dptrs", "1"
        RTMODEL "__rt_version", "1"

        RSEG DOVERLAY:DATA:NOROOT(0)
        RSEG IOVERLAY:IDATA:NOROOT(0)
        RSEG ISTACK:IDATA:NOROOT(0)
        RSEG PSTACK:XDATA:NOROOT(0)
        RSEG XSTACK:XDATA:NOROOT(0)

        EXTERN ?V0
        EXTERN ?V1
        EXTERN ?V2
        EXTERN ?V3
        EXTERN ?V4
        EXTERN ?V5
        EXTERN ?V6
        EXTERN ?V7
        EXTERN ?ALLOC_XSTACK8
        EXTERN ?BANKED_ENTER_XDATA
        EXTERN ?BANKED_LEAVE_XDATA
        EXTERN ?BDISPATCH
        EXTERN ?BRET
        EXTERN ?DEALLOC_XSTACK8
        EXTERN ?PUSH_XSTACK_I_TWO
        EXTERN ?XSP
        EXTERN ?XSTACK_DISP0_8
        EXTERN __INIT_XDATA_Z

        PUBLIC ??ZXBeeAdd?relay
        FUNCTION ??ZXBeeAdd?relay,0203H
        PUBLIC ??ZXBeeBegin?relay
        FUNCTION ??ZXBeeBegin?relay,0203H
        PUBLIC ??ZXBeeDecodePackage?relay
        FUNCTION ??ZXBeeDecodePackage?relay,0203H
        PUBLIC ??ZXBeeEnd?relay
        FUNCTION ??ZXBeeEnd?relay,0203H
        PUBLIC ZXBeeAdd
        FUNCTION ZXBeeAdd,0a1203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME XSTACK, 18, STACK
        PUBLIC ZXBeeBegin
        FUNCTION ZXBeeBegin,0203H
        ARGFRAME XSTACK, 20, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME ISTACK, 2, STACK
        PUBLIC ZXBeeDecodePackage
        FUNCTION ZXBeeDecodePackage,0a1203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME XSTACK, 20, STACK
        PUBLIC ZXBeeEnd
        FUNCTION ZXBeeEnd,0a1203H
        ARGFRAME XSTACK, 20, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME XSTACK, 10, STACK
        
          CFI Names cfiNames0
          CFI StackFrame CFA_SP SP IDATA
          CFI StackFrame CFA_PSP16 PSP16 XDATA
          CFI StackFrame CFA_XSP16 XSP16 XDATA
          CFI StaticOverlayFrame CFA_IOVERLAY IOVERLAY
          CFI StaticOverlayFrame CFA_DOVERLAY DOVERLAY
          CFI Resource `PSW.CY`:1, `B.BR0`:1, `B.BR1`:1, `B.BR2`:1, `B.BR3`:1
          CFI Resource `B.BR4`:1, `B.BR5`:1, `B.BR6`:1, `B.BR7`:1, `VB.BR8`:1
          CFI Resource `VB.BR9`:1, `VB.BR10`:1, `VB.BR11`:1, `VB.BR12`:1
          CFI Resource `VB.BR13`:1, `VB.BR14`:1, `VB.BR15`:1, VB:8, B:8, A:8
          CFI Resource PSW:8, DPL0:8, DPH0:8, R0:8, R1:8, R2:8, R3:8, R4:8, R5:8
          CFI Resource R6:8, R7:8, V0:8, V1:8, V2:8, V3:8, V4:8, V5:8, V6:8, V7:8
          CFI Resource SP:8, PSPH:8, PSPL:8, PSP16:16, XSPH:8, XSPL:8, XSP16:16
          CFI VirtualResource ?RET:24
          CFI Resource ?BRET_EXT:8
          CFI VirtualResource ?RET_HIGH:8, ?RET_LOW:8
          CFI ResourceParts PSP16 PSPH, PSPL
          CFI ResourceParts XSP16 XSPH, XSPL
          CFI ResourceParts ?RET ?BRET_EXT, ?RET_HIGH, ?RET_LOW
          CFI EndNames cfiNames0
        
          CFI Common cfiCommon0 Using cfiNames0
          CFI CodeAlign 1
          CFI DataAlign -1
          CFI ReturnAddress ?RET CODE
          CFI CFA_DOVERLAY Used
          CFI CFA_IOVERLAY Used
          CFI CFA_SP SP+-3
          CFI CFA_PSP16 PSP16+0
          CFI CFA_XSP16 XSP16+0
          CFI `PSW.CY` SameValue
          CFI `B.BR0` SameValue
          CFI `B.BR1` SameValue
          CFI `B.BR2` SameValue
          CFI `B.BR3` SameValue
          CFI `B.BR4` SameValue
          CFI `B.BR5` SameValue
          CFI `B.BR6` SameValue
          CFI `B.BR7` SameValue
          CFI `VB.BR8` SameValue
          CFI `VB.BR9` SameValue
          CFI `VB.BR10` SameValue
          CFI `VB.BR11` SameValue
          CFI `VB.BR12` SameValue
          CFI `VB.BR13` SameValue
          CFI `VB.BR14` SameValue
          CFI `VB.BR15` SameValue
          CFI VB SameValue
          CFI B Undefined
          CFI A Undefined
          CFI PSW SameValue
          CFI DPL0 SameValue
          CFI DPH0 SameValue
          CFI R0 Undefined
          CFI R1 Undefined
          CFI R2 Undefined
          CFI R3 Undefined
          CFI R4 Undefined
          CFI R5 Undefined
          CFI R6 SameValue
          CFI R7 SameValue
          CFI V0 SameValue
          CFI V1 SameValue
          CFI V2 SameValue
          CFI V3 SameValue
          CFI V4 SameValue
          CFI V5 SameValue
          CFI V6 SameValue
          CFI V7 SameValue
          CFI PSPH Undefined
          CFI PSPL Undefined
          CFI XSPH Undefined
          CFI XSPL Undefined
          CFI ?RET Concat
          CFI ?BRET_EXT Frame(CFA_SP, 3)
          CFI ?RET_HIGH Frame(CFA_SP, 2)
          CFI ?RET_LOW Frame(CFA_SP, 1)
          CFI EndCommon cfiCommon0
        
ZXBeeSysCommandProc SYMBOL "ZXBeeSysCommandProc"
??ZXBeeSysCommandProc?relay SYMBOL "?relay", ZXBeeSysCommandProc
sprintf             SYMBOL "sprintf"
??sprintf?relay     SYMBOL "?relay", sprintf
strchr              SYMBOL "strchr"
??strchr?relay      SYMBOL "?relay", strchr
strlen              SYMBOL "strlen"
??strlen?relay      SYMBOL "?relay", strlen
ZXBeeAdd            SYMBOL "ZXBeeAdd"
??ZXBeeAdd?relay    SYMBOL "?relay", ZXBeeAdd
ZXBeeBegin          SYMBOL "ZXBeeBegin"
??ZXBeeBegin?relay  SYMBOL "?relay", ZXBeeBegin
ZXBeeDecodePackage  SYMBOL "ZXBeeDecodePackage"
??ZXBeeDecodePackage?relay SYMBOL "?relay", ZXBeeDecodePackage
ZXBeeEnd            SYMBOL "ZXBeeEnd"
??ZXBeeEnd?relay    SYMBOL "?relay", ZXBeeEnd

        EXTERN ??ZXBeeSysCommandProc?relay
        FUNCTION ??ZXBeeSysCommandProc?relay,00H
        EXTERN ??sprintf?relay
        FUNCTION ??sprintf?relay,00H
        EXTERN ??strchr?relay
        FUNCTION ??strchr?relay,00H
        EXTERN ??strlen?relay
        FUNCTION ??strlen?relay,00H
        EXTERN ZXBeeSysCommandProc
        FUNCTION ZXBeeSysCommandProc,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 20, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN sprintf
        FUNCTION sprintf,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 18, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN strchr
        FUNCTION strchr,010202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 20, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN strlen
        FUNCTION strlen,010202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 14, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC

// I:\1_git_code\EPnode_OTA\CC2530 IAP\CC2530_stack\zstack-2.4.0-1.4.0x\Projects\zstack\Samples\common\zxbee.c
//    1 /*********************************************************************************************
//    2 * 文件：zxbee.c
//    3 * 作者：Xuzhy 2018.5.16
//    4 * 说明：ZXBee通信协议数据包解包
//    5 * 修改：fuyou 增加透传驱动
//    6 * 注释：
//    7 *********************************************************************************************/
//    8 
//    9 /*********************************************************************************************
//   10 * 头文件
//   11 *********************************************************************************************/
//   12 #include <stdio.h>
//   13 #include <stdlib.h>
//   14 #include <string.h>
//   15 #include "hal_types.h"
//   16 #include "zxbee.h"
//   17 /*********************************************************************************************
//   18 * 宏定义
//   19 *********************************************************************************************/
//   20 
//   21 /*********************************************************************************************
//   22 * 全局变量
//   23 *********************************************************************************************/

        RSEG XDATA_Z:XDATA:NOROOT(0)
        DATA8
//   24 static char wbuf[96];
wbuf:
        DS 96
        REQUIRE __INIT_XDATA_Z
//   25 /*********************************************************************************************
//   26 * 函数原型说明
//   27 *********************************************************************************************/
//   28 int ZXBeeSysCommandProc(char *ptag, char *pval);
//   29 int ZXBeeUserProcess(char *ptag, char *pval);
//   30 /*********************************************************************************************
//   31 * 名称：ZXBeeBegin()
//   32 * 功能：ZXBee通信协议的帧头“{”
//   33 * 参数：
//   34 * 返回：
//   35 * 修改：
//   36 * 注释：
//   37 *********************************************************************************************/

        RSEG BANKED_CODE:CODE:NOROOT(0)
//   38 int8 ZXBeeBegin(void)
ZXBeeBegin:
          CFI Block cfiBlock0 Using cfiCommon0
          CFI Function ZXBeeBegin
        CODE
//   39 {
        PUSH    DPL
          CFI DPL0 Frame(CFA_SP, 4)
          CFI CFA_SP SP+-4
        PUSH    DPH
          CFI DPH0 Frame(CFA_SP, 5)
          CFI CFA_SP SP+-5
        ; Saved register size: 2
        ; Auto size: 0
//   40   wbuf[0] = '{';
        MOV     DPTR,#wbuf
        MOV     A,#0x7b
        MOVX    @DPTR,A
//   41   wbuf[1] = '\0';
        MOV     DPTR,#wbuf + 1
        MOV     A,#0x0
        MOVX    @DPTR,A
//   42   return 1;
        MOV     R1,#0x1
        POP     DPH
          CFI DPH0 SameValue
          CFI CFA_SP SP+-4
        POP     DPL
          CFI DPL0 SameValue
          CFI CFA_SP SP+-3
        LJMP    ?BRET
          CFI EndBlock cfiBlock0
//   43 }
//   44 /*********************************************************************************************
//   45 * 名称：ZXBeeAdd()
//   46 * 功能：ZXBee通信协议的数据包中添加数据
//   47 * 参数：tag -- 变量；val -- 值
//   48 * 返回：len -- 数据长度
//   49 * 修改：
//   50 * 注释：
//   51 *********************************************************************************************/

        RSEG BANKED_CODE:CODE:NOROOT(0)
//   52 int8 ZXBeeAdd(char* tag, char* val)
ZXBeeAdd:
          CFI Block cfiBlock1 Using cfiCommon0
          CFI Function ZXBeeAdd
        CODE
//   53 {
        FUNCALL ZXBeeAdd, strlen
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 14, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 14, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZXBeeAdd, sprintf
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 18, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 18, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZXBeeAdd, strlen
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 14, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 14, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        REQUIRE ?V0
        REQUIRE ?V1
        REQUIRE ?V2
        REQUIRE ?V3
        REQUIRE ?V4
        REQUIRE ?V5
        MOV     A,#-0xe
        LCALL   ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 14)
        ; Saved register size: 14
        ; Auto size: 0
        MOV     ?V0,R2
        MOV     ?V1,R3
        MOV     ?V2,R4
        MOV     ?V3,R5
//   54   sprintf(&wbuf[strlen(wbuf)], "%s=%s,", tag, val);
        ; Setup parameters for call to function strlen
        MOV     R2,#wbuf & 0xff
        MOV     R3,#(wbuf >> 8) & 0xff
        LCALL   ??strlen?relay       ; Banked call to: strlen
        MOV     ?V4,R2
        MOV     ?V5,R3
        MOV     R2,?V4
        MOV     R3,?V5
        ; Setup parameters for call to function sprintf
        MOV     R0,#?V2
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 16)
        MOV     R0,#?V0
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 18)
        MOV     R4,#`?<Constant "%s=%s,">` & 0xff
        MOV     R5,#(`?<Constant "%s=%s,">` >> 8) & 0xff
        MOV     A,#wbuf & 0xff
        ADD     A,R2
        MOV     R2,A
        MOV     A,#(wbuf >> 8) & 0xff
        ADDC    A,R3
        MOV     R3,A
        LCALL   ??sprintf?relay      ; Banked call to: sprintf
        MOV     A,#0x4
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 14)
//   55   return strlen(wbuf);
        ; Setup parameters for call to function strlen
        MOV     R2,#wbuf & 0xff
        MOV     R3,#(wbuf >> 8) & 0xff
        LCALL   ??strlen?relay       ; Banked call to: strlen
        MOV     A,R2
        MOV     R1,A
        MOV     R7,#0x6
        LJMP    ?BANKED_LEAVE_XDATA
          CFI EndBlock cfiBlock1
//   56 }
//   57 /*********************************************************************************************
//   58 * 名称：ZXBeeEnd()
//   59 * 功能：ZXBee通信协议的数据包添加结束帧“}”,并返回封包后的数据包指针
//   60 * 参数：wbuf -- 返回封包后的数据包指针
//   61 * 返回：
//   62 * 修改：
//   63 * 注释：
//   64 *********************************************************************************************/

        RSEG BANKED_CODE:CODE:NOROOT(0)
//   65 char* ZXBeeEnd(void)
ZXBeeEnd:
          CFI Block cfiBlock2 Using cfiCommon0
          CFI Function ZXBeeEnd
        CODE
//   66 {
        FUNCALL ZXBeeEnd, strlen
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 10, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 10, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        REQUIRE ?V0
        REQUIRE ?V1
        MOV     A,#-0xa
        LCALL   ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 10)
        ; Saved register size: 10
        ; Auto size: 0
//   67   int offset = strlen(wbuf);
        ; Setup parameters for call to function strlen
        MOV     R2,#wbuf & 0xff
        MOV     R3,#(wbuf >> 8) & 0xff
        LCALL   ??strlen?relay       ; Banked call to: strlen
        MOV     ?V0,R2
        MOV     ?V1,R3
        MOV     R0,?V0
        MOV     R1,?V1
//   68   wbuf[offset-1] = '}';
        MOV     A,#(wbuf + 255) & 0xff
        ADD     A,R0
        MOV     DPL,A
        MOV     A,#((wbuf - 1) >> 8) & 0xff
        ADDC    A,R1
        MOV     DPH,A
        MOV     A,#0x7d
        MOVX    @DPTR,A
//   69   wbuf[offset] = '\0';
        MOV     A,#wbuf & 0xff
        ADD     A,R0
        MOV     DPL,A
        MOV     A,#(wbuf >> 8) & 0xff
        ADDC    A,R1
        MOV     DPH,A
        MOV     A,#0x0
        MOVX    @DPTR,A
//   70   if (offset > 2) return wbuf;
        CLR     C
        MOV     A,R0
        SUBB    A,#0x3
        MOV     A,R1
        SUBB    A,#0x0
        MOV     C,0xD0 /* PSW */.2
        XRL     A,PSW
        RLC     A
        JC      ??ZXBeeEnd_0
        MOV     R2,#wbuf & 0xff
        MOV     R3,#(wbuf >> 8) & 0xff
        SJMP    ??ZXBeeEnd_1
//   71   return NULL;
??ZXBeeEnd_0:
        MOV     R2,#0x0
        MOV     R3,#0x0
??ZXBeeEnd_1:
        MOV     R7,#0x2
        LJMP    ?BANKED_LEAVE_XDATA
          CFI EndBlock cfiBlock2
//   72 }
//   73 /*********************************************************************************************
//   74 * 名称：ZXBeeDecodePackage()
//   75 * 功能：对接收到的无线数据包进行解包
//   76 * 参数：pkg -- 数据   len -- 数据长度
//   77 * 返回：p -- 返回的数据包
//   78 * 修改：
//   79 * 注释：
//   80 *********************************************************************************************/

        RSEG BANKED_CODE:CODE:NOROOT(0)
//   81 char* ZXBeeDecodePackage(char *pkg, int len)
ZXBeeDecodePackage:
          CFI Block cfiBlock3 Using cfiCommon0
          CFI Function ZXBeeDecodePackage
        CODE
//   82 {
        FUNCALL ZXBeeDecodePackage, ZXBeeBegin
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 20, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 20, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZXBeeDecodePackage, strchr
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 20, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 20, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZXBeeDecodePackage, strchr
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 20, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 20, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZXBeeDecodePackage, ZXBeeSysCommandProc
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 20, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 20, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL ZXBeeDecodePackage, ZXBeeEnd
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 20, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 20, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        REQUIRE ?V0
        REQUIRE ?V1
        REQUIRE ?V2
        REQUIRE ?V3
        REQUIRE ?V4
        REQUIRE ?V5
        REQUIRE ?V6
        REQUIRE ?V7
        MOV     A,#-0x10
        LCALL   ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V7 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V6 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 16)
        ; Saved register size: 16
        ; Auto size: 4
        MOV     A,#-0x4
        LCALL   ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 20)
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     A,R4
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,R5
        MOVX    @DPTR,A
        MOV     ?V0,R2
        MOV     ?V1,R3
//   83   char *p;
//   84   char *ptag = NULL;
        MOV     ?V2,#0x0
        MOV     ?V3,#0x0
//   85   char *pval = NULL;
        MOV     ?V6,#0x0
        MOV     ?V7,#0x0
//   86 
//   87   if (pkg[0] != '{' || pkg[len-1] != '}') return NULL;
        MOV     DPL,?V0
        MOV     DPH,?V1
        MOVX    A,@DPTR
        XRL     A,#0x7b
        JNZ     ??ZXBeeDecodePackage_0
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R1,A
        MOV     A,?V0
        ADD     A,R0
        MOV     R0,A
        MOV     A,?V1
        ADDC    A,R1
        MOV     R1,A
        MOV     A,R0
        ADD     A,#-0x1
        MOV     DPL,A
        MOV     A,R1
        ADDC    A,#-0x1
        MOV     DPH,A
        MOVX    A,@DPTR
        XRL     A,#0x7d
        JZ      ??ZXBeeDecodePackage_1
??ZXBeeDecodePackage_0:
        MOV     R2,#0x0
        MOV     R3,#0x0
        LJMP    ??ZXBeeDecodePackage_2 & 0xFFFF
//   88   
//   89   ZXBeeBegin();
??ZXBeeDecodePackage_1:
        ; Setup parameters for call to function ZXBeeBegin
        LCALL   ??ZXBeeBegin?relay   ; Banked call to: ZXBeeBegin
        MOV     A,R1
//   90 
//   91   pkg[len-1] = 0;
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R1,A
        MOV     A,?V0
        ADD     A,R0
        MOV     R0,A
        MOV     A,?V1
        ADDC    A,R1
        MOV     R1,A
        MOV     A,R0
        ADD     A,#-0x1
        MOV     DPL,A
        MOV     A,R1
        ADDC    A,#-0x1
        MOV     DPH,A
        MOV     A,#0x0
        MOVX    @DPTR,A
//   92   p = pkg+1;
        MOV     DPL,?V0
        MOV     DPH,?V1
        INC     DPTR
        MOV     R6,DPL
        MOV     R7,DPH
//   93   do {
//   94     ptag = p;
??ZXBeeDecodePackage_3:
        MOV     ?V2,R6
        MOV     ?V3,R7
//   95     p = strchr(p, '=');
        ; Setup parameters for call to function strchr
        MOV     R4,#0x3d
        MOV     R5,#0x0
        MOV     A,R6
        MOV     R2,A
        MOV     A,R7
        MOV     R3,A
        LCALL   ??strchr?relay       ; Banked call to: strchr
        MOV     ?V4,R2
        MOV     ?V5,R3
        MOV     R6,?V4
        MOV     R7,?V5
//   96     if (p != NULL) {
        MOV     A,R6
        ORL     A,R7
        JZ      ??ZXBeeDecodePackage_4
//   97       *p++ = 0;
        MOV     DPL,R6
        MOV     DPH,R7
        MOV     A,#0x0
        MOVX    @DPTR,A
        MOV     DPL,R6
        MOV     DPH,R7
        INC     DPTR
        MOV     R6,DPL
        MOV     R7,DPH
//   98       pval = p;
        MOV     ?V6,R6
        MOV     ?V7,R7
//   99       p = strchr(p, ',');
        ; Setup parameters for call to function strchr
        MOV     R4,#0x2c
        MOV     R5,#0x0
        MOV     A,R6
        MOV     R2,A
        MOV     A,R7
        MOV     R3,A
        LCALL   ??strchr?relay       ; Banked call to: strchr
        MOV     ?V4,R2
        MOV     ?V5,R3
        MOV     R6,?V4
        MOV     R7,?V5
//  100       if (p != NULL) *p++ = 0;
        MOV     A,R6
        ORL     A,R7
        JZ      ??ZXBeeDecodePackage_5
        MOV     DPL,R6
        MOV     DPH,R7
        MOV     A,#0x0
        MOVX    @DPTR,A
        MOV     DPL,R6
        MOV     DPH,R7
        INC     DPTR
        MOV     R6,DPL
        MOV     R7,DPH
//  101       int ret;
//  102       ret = ZXBeeSysCommandProc(ptag, pval);
??ZXBeeDecodePackage_5:
        ; Setup parameters for call to function ZXBeeSysCommandProc
        MOV     R4,?V6
        MOV     R5,?V7
        MOV     R2,?V2
        MOV     R3,?V3
        LCALL   ??ZXBeeSysCommandProc?relay; Banked call to: ZXBeeSysCommandProc
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP0_8
        MOV     A,R2
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,R3
        MOVX    @DPTR,A
//  103       if (ret < 0) {
//  104 #ifndef CC2530_Serial
//  105                 ret = ZXBeeUserProcess(ptag, pval);
//  106 #endif
//  107       }
//  108     }
//  109   } while (p != NULL);
??ZXBeeDecodePackage_4:
        MOV     A,R6
        ORL     A,R7
        JNZ     ??ZXBeeDecodePackage_3
//  110   p = ZXBeeEnd();
        ; Setup parameters for call to function ZXBeeEnd
        LCALL   ??ZXBeeEnd?relay     ; Banked call to: ZXBeeEnd
        MOV     ?V4,R2
        MOV     ?V5,R3
        MOV     R6,?V4
        MOV     R7,?V5
//  111 
//  112   return p;
        MOV     A,R6
        MOV     R2,A
        MOV     A,R7
        MOV     R3,A
??ZXBeeDecodePackage_2:
        MOV     A,#0x4
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 16)
        MOV     R7,#0x8
        LJMP    ?BANKED_LEAVE_XDATA
          CFI EndBlock cfiBlock3
//  113 }

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??ZXBeeBegin?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZXBeeBegin

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??ZXBeeAdd?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZXBeeAdd

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??ZXBeeEnd?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZXBeeEnd

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??ZXBeeDecodePackage?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    ZXBeeDecodePackage

        RSEG XDATA_ROM_C:CONST:REORDER:NOROOT(0)
        DATA8
`?<Constant "%s=%s,">`:
        DB "%s=%s,"

        END
// 
// 444 bytes in segment BANKED_CODE
//  24 bytes in segment BANK_RELAYS
//   7 bytes in segment XDATA_ROM_C
//  96 bytes in segment XDATA_Z
// 
// 468 bytes of CODE  memory
//   7 bytes of CONST memory
//  96 bytes of XDATA memory
//
//Errors: none
//Warnings: none
