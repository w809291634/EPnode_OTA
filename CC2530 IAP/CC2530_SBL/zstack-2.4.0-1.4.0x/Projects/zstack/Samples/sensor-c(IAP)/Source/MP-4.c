/*********************************************************************************************
* 文件：MP-4.c
* 作者：Lixm 2017.10.17
* 说明：可燃气体驱动代码
* 修改：fuyou 2018.08.03 增加对应硬件版本的驱动
* 注释：
*********************************************************************************************/

/*********************************************************************************************
* 头文件
*********************************************************************************************/
#include "MP-4.h"
#include  "hal_adc.h"

/*********************************************************************************************
* 名称：CombustibleGas_init()
* 功能：可燃气体传感器初始化
* 参数：无
* 返回：无
* 修改：
* 注释：
*********************************************************************************************/
void combustiblegas_init(void)
{
      APCFG |= 0x20;                                                //模拟 I/O 使能  
      P0SEL |= 0x20;                                                //端口0_5 功能选择外设功能
      P0DIR &= ~0x20;                                               //设置输入模式  
}

/*********************************************************************************************
* 名称：unsigned int get_infrared_status(void)
* 功能：获取可燃气体传感器状态
* 参数：无
* 返回：无
* 修改：
* 注释：
*********************************************************************************************/
unsigned int get_combustiblegas_data(void)
{ 
    unsigned int  value;
    value = HalAdcRead (HAL_ADC_CHANNEL_5,HAL_ADC_RESOLUTION_12);
    
    if(value <= GAS_THRESHOLD)      //GAS_THRESHOLD：老版传感器--1600，新版传感器--800
        return 0;
    else
        return 1;
}